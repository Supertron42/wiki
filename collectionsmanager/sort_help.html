<!DOCTYPE html>
<html>
<head>
<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}
body {
    font-family: Segoe UI, Arial, sans-serif;
    font-size: 13px;
    line-height: 1.6;
    display: flex;
    height: 100%;
    background: #1e1e1e;
    color: #d4d4d4;
}

/* Left Navigation */
#nav {
    width: 180px;
    min-width: 180px;
    background: #252526;
    border-right: 1px solid #3c3c3c;
    padding: 10px 0;
    overflow-y: auto;
    position: fixed;
    height: 100%;
}
#nav h3 {
    color: #569cd6;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 10px 15px 5px;
    margin-top: 10px;
}
#nav h3:first-child {
    margin-top: 0;
}
#nav a {
    display: block;
    color: #d4d4d4;
    text-decoration: none;
    padding: 6px 15px 6px 20px;
    font-size: 12px;
    border-left: 3px solid transparent;
    transition: all 0.15s;
}
#nav a:hover {
    background: #2a2d2e;
    color: #fff;
    border-left-color: #569cd6;
}

/* Main Content */
#content {
    flex: 1;
    padding: 20px 30px;
    margin-left: 180px;
    overflow-y: auto;
}

h1 {
    font-size: 22px;
    color: #4ec9b0;
    border-bottom: 2px solid #4ec9b0;
    padding-bottom: 8px;
    margin: 30px 0 15px;
}
h1:first-child {
    margin-top: 0;
}
h2 {
    font-size: 16px;
    color: #dcdcaa;
    margin: 25px 0 10px;
}
h3 {
    font-size: 14px;
    color: #9cdcfe;
    margin: 15px 0 8px;
}
p {
    margin: 10px 0;
}
a {
    color: #569cd6;
}
code {
    background: #2d2d2d;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: Consolas, monospace;
    border: 1px solid #3c3c3c;
    color: #ce9178;
}

/* Callout boxes */
.warning {
    background: #3d3520;
    border-left: 4px solid #f0c020;
    padding: 12px 15px;
    margin: 15px 0;
    border-radius: 0 4px 4px 0;
}
.info {
    background: #1e3a5f;
    border-left: 4px solid #569cd6;
    padding: 12px 15px;
    margin: 15px 0;
    border-radius: 0 4px 4px 0;
}
.success {
    background: #1e3d2b;
    border-left: 4px solid #4ec9b0;
    padding: 12px 15px;
    margin: 15px 0;
    border-radius: 0 4px 4px 0;
}

ul, ol {
    margin: 10px 0;
    padding-left: 25px;
}
li {
    margin: 6px 0;
}

/* Tables */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
}
th, td {
    border: 1px solid #3c3c3c;
    padding: 8px 12px;
    text-align: left;
}
th {
    background: #2d2d2d;
    color: #4ec9b0;
}
tr:nth-child(even) {
    background: #252526;
}

/* Scroll margin for anchors */
[id] {
    scroll-margin-top: 20px;
}
</style>
</head>
<body>

<!-- Left Navigation -->
<div id="nav">
    <a href="wiki.html" style="display:block; padding:10px 15px; background:#DA8E35; color:white; font-weight:bold; text-align:center; margin-bottom:10px;">Wiki Home</a>
    <h3>Overview</h3>
    <a href="#purpose">Purpose</a>
    <a href="#workflow">Basic Workflow</a>

    <h3>Table Columns</h3>
    <a href="#columns">Column Reference</a>
    <a href="#status-indicators">Status Indicators</a>

    <h3>Features</h3>
    <a href="#preview">Preview & Detection</a>
    <a href="#reordering">Drag-Drop Reordering</a>
    <a href="#conflicts-pane">Conflicts Pane</a>
    <a href="#isolation">Isolation Mode</a>

    <h3>Settings</h3>
    <a href="#filters">Filter Options</a>
    <a href="#collection-order">Collection Order</a>
    <a href="#user-rules">User Rules</a>

    <h3>Saving & Loading</h3>
    <a href="#save-load">Save/Load Order</a>
    <a href="#apply">Applying Changes</a>

    <h3>Tips</h3>
    <a href="#best-practices">Best Practices</a>

    <!-- Premium Ad -->
    <div style="margin-top: 40px; padding: 12px; background: #1e1e1e; border-top: 1px solid #3c3c3c;">
        <div style="color: #DA8E35; font-weight: bold; font-size: 12px; text-align: center; margin-bottom: 10px;">
            Collections for MO2 Are Here
        </div>
        <div style="font-size: 11px; color: #9cdcfe; line-height: 1.5;">
            <div style="margin-bottom: 6px;">&#10003; Save thousands of clicks</div>
            <div style="margin-bottom: 6px;">&#10003; One-click collection setups</div>
            <div style="margin-bottom: 6px;">&#10003; Faster downloads</div>
            <div style="margin-bottom: 10px;">&#10003; Support the community</div>
        </div>
        <a href="https://users.nexusmods.com/account/billing/premium?utm_source=collaboration&utm_medium=link&utm_campaign=MO2_upsell&utm_term=MO2_user&utm_content=upsell_link_1"
           target="_blank"
           style="display: block; background: #DA8E35; color: white; font-weight: bold; text-align: center; padding: 8px 12px; border-radius: 4px; text-decoration: none; font-size: 12px;">
            Go Premium
        </a>
        <div style="text-align: center; margin-top: 12px;">
            <img src="nexus mods logo.png" alt="Nexus Mods" style="width: 80px; height: auto;">
        </div>
    </div>
</div>

<!-- Main Content -->
<div id="content">

<h1 id="purpose">Purpose of the Sort Tool</h1>
<p>The Sort Mod List tool helps you organize your MO2 mod list to match the collection author's intended install order. It provides:</p>
<ul>
    <li>Visual preview of your mod list with conflict detection</li>
    <li>Automatic sorting based on collection install order</li>
    <li>Drag-and-drop reordering for manual adjustments</li>
    <li>Conflict highlighting to identify which mods overwrite each other</li>
    <li>Isolation mode to focus on specific mod conflicts</li>
</ul>

<div class="info">
<b>Why Sort Order Matters:</b> In MO2, mods lower in the list overwrite mods higher up. The collection author carefully ordered mods so that patches, fixes, and compatibility files load after the mods they modify. Following this order ensures everything works together correctly.
</div>


<h1 id="workflow">Basic Workflow</h1>
<ol>
    <li><b>Click Preview</b> - Loads all mods and detects file conflicts</li>
    <li><b>Review the list</b> - Check for conflicts (red/green highlighting)</li>
    <li><b>Make adjustments</b> - Drag mods to reorder if needed</li>
    <li><b>Click Apply Sort Order</b> - Apply the new order to MO2</li>
</ol>

<div class="warning">
<b>Important:</b> The Preview button must be clicked before you can apply changes. This ensures you see the current state before modifying anything.
</div>


<h1 id="columns">Table Columns</h1>
<table>
    <tr><th>Column</th><th>Description</th></tr>
    <tr><td><b>No.</b></td><td>Row number showing the current position in the sort order</td></tr>
    <tr><td><b>Status</b></td><td>Mod status indicators (enabled, disabled, problem, etc.)</td></tr>
    <tr><td><b>Mod Name</b></td><td>The mod's display name, with collection tags if applicable</td></tr>
    <tr><td><b>Category</b></td><td>The mod's assigned category from MO2</td></tr>
    <tr><td><b>Version</b></td><td>The mod's version number</td></tr>
    <tr><td><b>Conflicts</b></td><td>Count of overwrites/overwritten files with other mods</td></tr>
</table>


<h1 id="status-indicators">Status Indicators</h1>
<table>
    <tr><th>Indicator</th><th>Meaning</th></tr>
    <tr><td style="color:#4ec9b0;">&#10004; Enabled</td><td>Mod is active and will be loaded</td></tr>
    <tr><td style="color:#888;">&#10006; Disabled</td><td>Mod is inactive (only shown with "Show disabled" option)</td></tr>
    <tr><td style="color:#f0c020;">&#9888; Problem</td><td>Mod has invalid data or missing Nexus ID</td></tr>
    <tr><td style="color:#569cd6;">&#127760; Unmanaged</td><td>Mod is in game Data folder (DLC, Creation Club)</td></tr>
    <tr><td style="color:#ce9178;">&#128230; Bundle</td><td>Mod was installed from a collection bundle</td></tr>
</table>

<h3>Row Highlighting</h3>
<table>
    <tr><th>Color</th><th>Meaning</th></tr>
    <tr><td style="background:rgba(255,100,100,0.3); padding:4px;">Red background</td><td>This mod is being overwritten (losing conflicts)</td></tr>
    <tr><td style="background:rgba(100,255,150,0.3); padding:4px;">Green background</td><td>This mod is overwriting others (winning conflicts)</td></tr>
</table>


<h1 id="preview">Preview & Conflict Detection</h1>
<p>Clicking <b>Preview</b> performs several operations:</p>
<ol>
    <li>Scans all mods in your MO2 mod list</li>
    <li>Reads collection markers to identify collection mods</li>
    <li>Detects file conflicts between mods</li>
    <li>Applies collection sort order (if enabled)</li>
    <li>Populates the table with results</li>
</ol>

<h3>Conflict Detection</h3>
<p>The tool analyzes which files each mod provides and identifies overlaps:</p>
<ul>
    <li><b>Overwrites</b> - Files this mod provides that overwrite other mods</li>
    <li><b>Overwritten by</b> - Files from other mods that overwrite this mod</li>
</ul>

<div class="info">
<b>Tip:</b> Click on any mod to see its specific conflicts in the left pane. This helps you understand why certain mods need to be in a specific order.
</div>


<h1 id="reordering">Drag-Drop Reordering</h1>
<p>You can manually adjust the sort order by dragging mods:</p>
<ol>
    <li>Select one or more mods (Ctrl+click for multiple)</li>
    <li>Drag them to the desired position</li>
    <li>Release to drop them after the target mod</li>
</ol>

<h3>How It Works</h3>
<ul>
    <li>Dropped mods are placed <b>after</b> the target mod</li>
    <li>Multiple selected mods maintain their relative order</li>
    <li>Your changes are tracked as "user rules" for future sorting</li>
</ul>

<div class="warning">
<b>Note:</b> Manual reordering creates "load after" rules. These rules persist and will be reapplied when you preview again. Use Settings &gt; Delete User Rules to clear them.
</div>


<h1 id="conflicts-pane">Conflicts Pane</h1>
<p>The left pane shows detailed conflict information for the selected mod:</p>
<ul>
    <li><b>Title</b> - Shows the selected mod's name</li>
    <li><b>Table</b> - Lists all mods that conflict with the selected mod</li>
    <li><b>Colors</b> - Red = losing to this mod, Green = winning over this mod</li>
</ul>

<h3>Using the Conflicts Pane</h3>
<ol>
    <li>Click any mod in the main table</li>
    <li>The conflicts pane shows all mods that share files with it</li>
    <li>Click a conflict to highlight it in the main table</li>
    <li>Drag mods within the conflicts pane to reorder them</li>
</ol>

<h3>Collapse/Expand</h3>
<p>Use the arrow button to collapse or expand the conflicts pane. When collapsed, a highlighted expand button appears on the left edge.</p>


<h1 id="isolation">Isolation Mode</h1>
<p>Isolation mode filters the view to show only mods related to a specific conflict:</p>
<ol>
    <li>Right-click any mod in the table</li>
    <li>Select <b>Isolation Mode - Show Only Conflicts</b></li>
    <li>The table now shows only that mod and its conflicts</li>
    <li>Right-click and select <b>Exit Isolation Mode</b> to return</li>
</ol>

<h3>Deep Isolation</h3>
<p>When enabled in Settings, isolation mode also shows "conflicts of conflicts" - mods that conflict with the conflicting mods. This helps you see the full chain of dependencies.</p>


<h1 id="filters">Filter Options</h1>
<p>Access these options via the <b>Settings</b> button:</p>

<table>
    <tr><th>Option</th><th>Description</th></tr>
    <tr><td><b>Only show mods with conflicts</b></td><td>Hide mods that have no file overlaps</td></tr>
    <tr><td><b>Show disabled mods</b></td><td>Include inactive mods in the list</td></tr>
    <tr><td><b>Sort problem mods to top</b></td><td>Always show mods with issues at the top</td></tr>
    <tr><td><b>Sort unmanaged mods to top</b></td><td>Put DLC and game files at the top</td></tr>
    <tr><td><b>Sort bundles last</b></td><td>Always keep bundle mods at the bottom</td></tr>
    <tr><td><b>Show 'No Collection' tag</b></td><td>Mark mods not part of any collection</td></tr>
</table>


<h1 id="collection-order">Collection Order</h1>
<p>The tool can automatically sort mods based on collection install order:</p>

<h3>Collection Selector</h3>
<p>In Settings, choose which collection's order to use:</p>
<ul>
    <li><b>Merge All</b> - Combines order from all loaded collections</li>
    <li><b>Specific collection</b> - Use only that collection's order</li>
</ul>

<h3>How Sorting Works</h3>
<ol>
    <li>Mods are matched to collection entries by file ID or name</li>
    <li>Matched mods are sorted by their position in the collection</li>
    <li>Unmatched mods are placed at the end</li>
    <li>User rules (from manual reordering) are applied on top</li>
</ol>

<div class="info">
<b>Phases:</b> Collections can have multiple phases (0, 1, etc.). Mods in phase 0 always sort before mods in phase 1. This ensures prerequisites load before the mods that need them.
</div>


<h1 id="user-rules">User Rules</h1>
<p>When you drag mods to reorder them, the tool creates "load after" rules:</p>
<ul>
    <li>Rules are saved automatically and persist between sessions</li>
    <li>They override collection order for those specific mods</li>
    <li>Useful for custom patches or personal preferences</li>
</ul>

<h3>Clearing User Rules</h3>
<p>To reset all manual ordering:</p>
<ol>
    <li>Click <b>Settings</b></li>
    <li>Click <b>Delete User Rules</b></li>
    <li>Confirm the action</li>
    <li>Click <b>OK</b></li>
</ol>


<h1 id="save-load">Save/Load Order</h1>

<h3>Save Order</h3>
<p>Export your current sort order to a file for backup or sharing:</p>
<ol>
    <li>Click <b>Save Order</b></li>
    <li>Choose a location and filename</li>
    <li>The file includes mod positions and user rules</li>
</ol>

<h3>Load Order</h3>
<p>Import a previously saved sort order:</p>
<ol>
    <li>Click <b>Load Order</b></li>
    <li>Select the saved order file</li>
    <li>The table updates to match the loaded order</li>
    <li>Click <b>Apply Sort Order</b> to apply it to MO2</li>
</ol>

<div class="info">
<b>Sharing:</b> You can share saved order files with others who have the same mod list. This is useful for helping someone troubleshoot or sharing an optimized order.
</div>


<h1 id="apply">Applying Changes</h1>
<p>Click <b>Apply Sort Order</b> to apply the displayed order to MO2:</p>
<ol>
    <li>Each mod's priority is updated to match its position in the table</li>
    <li>MO2's mod list updates immediately</li>
    <li>Your game will now use this load order</li>
</ol>

<div class="warning">
<b>Caution:</b> Applying changes modifies your actual MO2 mod order. If you're unsure, use Save Order first to create a backup.
</div>


<h1 id="best-practices">Best Practices</h1>

<div class="success">
<ul>
    <li><b>Preview first</b> - Always preview before making changes</li>
    <li><b>Check conflicts</b> - Review red-highlighted mods for potential issues</li>
    <li><b>Trust collection order</b> - Collection authors test their load orders</li>
    <li><b>Use isolation mode</b> - For complex conflicts, isolate and resolve one at a time</li>
    <li><b>Save before changes</b> - Export your current order before major adjustments</li>
    <li><b>Apply and test</b> - Apply changes and test in-game to verify</li>
</ul>
</div>

<h3>When to Manually Reorder</h3>
<ul>
    <li>Custom patches you've added that aren't in the collection</li>
    <li>Personal preference mods that should override collection mods</li>
    <li>Troubleshooting specific mod conflicts</li>
</ul>

<h3>When to Use Collection Order</h3>
<ul>
    <li>Fresh collection installation - let the author's order take effect</li>
    <li>After updating a collection - reset to the new recommended order</li>
    <li>Troubleshooting issues - return to a known-good configuration</li>
</ul>

</div>
</body>
</html>
